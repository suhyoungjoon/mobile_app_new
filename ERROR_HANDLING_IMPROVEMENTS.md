# ğŸ”§ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„  ê°€ì´ë“œ

## ğŸ“‹ ê°œì„  ëª©í‘œ

1. **í™˜ê²½ë³€ìˆ˜ ë¯¸ì„¤ì • ì‹œ**: ê¸°ëŠ¥ì´ ì‘ë™í•˜ì§€ ì•Šë”ë¼ë„ ì•±ì´ ê³„ì† ì‹¤í–‰ë˜ë„ë¡
2. **ê¸°ëŠ¥ ë¯¸êµ¬í˜„ ì‹œ**: ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ì™€ í•¨ê»˜ ëŒ€ì²´ ë°©ë²• ì œê³µ
3. **ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜**: ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ì™€ í•¨ê»˜ graceful degradation

---

## âœ… êµ¬í˜„ëœ ê°œì„  ì‚¬í•­

### 1. ì¤‘ì•™í™”ëœ ì—ëŸ¬ í•¸ë“¤ë§ ìœ í‹¸ë¦¬í‹°

**íŒŒì¼**: `backend/utils/errorHandler.js`

#### ì£¼ìš” ê¸°ëŠ¥:
- âœ… **í™˜ê²½ë³€ìˆ˜ ì²´í¬**: ì„œë²„ ì‹œì‘ ì‹œ í•„ìˆ˜/ì„ íƒ í™˜ê²½ë³€ìˆ˜ í™•ì¸
- âœ… **ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬**: ê° ê¸°ëŠ¥ì˜ ì„¤ì • ìƒíƒœ í™•ì¸
- âœ… **ì•ˆì „í•œ ì—ëŸ¬ ì‘ë‹µ ìƒì„±**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ìƒì„¸ ì •ë³´ ìˆ¨ê¹€
- âœ… **Express ë¯¸ë“¤ì›¨ì–´**: ì¤‘ì•™í™”ëœ ì—ëŸ¬ í•¸ë“¤ë§
- âœ… **ë¹„ë™ê¸° í•¨ìˆ˜ ë˜í¼**: ìë™ ì—ëŸ¬ ì²˜ë¦¬

#### ì‚¬ìš© ì˜ˆì‹œ:
```javascript
const { asyncHandler, isFeatureAvailable, createFeatureUnavailableError } = require('../utils/errorHandler');

// ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬
if (!isFeatureAvailable('youtube')) {
  return res.status(503).json(createFeatureUnavailableError('youtube'));
}

// ë¹„ë™ê¸° í•¨ìˆ˜ ìë™ ì—ëŸ¬ ì²˜ë¦¬
router.post('/endpoint', authenticateToken, asyncHandler(async (req, res) => {
  // ì—ëŸ¬ ë°œìƒ ì‹œ ìë™ìœ¼ë¡œ ì—ëŸ¬ í•¸ë“¤ëŸ¬ë¡œ ì „ë‹¬
  const result = await someAsyncOperation();
  res.json({ success: true, data: result });
}));
```

---

### 2. í™˜ê²½ë³€ìˆ˜ ì²´í¬ ë° ê²½ê³ 

**íŒŒì¼**: `backend/config.js`

#### ê°œì„  ë‚´ìš©:
- âœ… ì„œë²„ ì‹œì‘ ì‹œ í™˜ê²½ë³€ìˆ˜ ìë™ ì²´í¬
- âœ… í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ ëˆ„ë½ ì‹œ ì—ëŸ¬ ë¡œê¹…
- âœ… ì„ íƒì  í™˜ê²½ë³€ìˆ˜ ëˆ„ë½ ì‹œ ê²½ê³  ë¡œê¹…
- âœ… ê¸°ëŠ¥ë³„ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸

#### ì²´í¬ë˜ëŠ” í™˜ê²½ë³€ìˆ˜:
- **í•„ìˆ˜**: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì •ë³´
- **ì„ íƒì **: 
  - `YOUTUBE_API_KEY` - YouTube ê²€ìƒ‰ ê¸°ëŠ¥
  - `AZURE_OPENAI_ENDPOINT`, `AZURE_OPENAI_API_KEY` - Azure AI íŒì •
  - `TWILIO_ACCOUNT_SID`, `TWILIO_AUTH_TOKEN` - SMS ë°œì†¡
  - `VAPID_PUBLIC_KEY`, `VAPID_PRIVATE_KEY` - í‘¸ì‹œ ì•Œë¦¼

---

### 3. ë°±ì—”ë“œ API ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 

#### Azure AI ë¼ìš°íŠ¸ (`backend/routes/azure-ai.js`)

**ê°œì„  ë‚´ìš©**:
- âœ… Azure OpenAI ì„¤ì • í™•ì¸
- âœ… ì¸ì¦ ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ë©”ì‹œì§€
- âœ… í• ë‹¹ëŸ‰ ì´ˆê³¼ ì‹œ ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€
- âœ… ë¶„ì„ ì‹¤íŒ¨ ì‹œ graceful degradation (ìˆ˜ë™ ë“±ë¡ ì•ˆë‚´)

**ì—ëŸ¬ ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "success": false,
  "error": "azure_ai_auth_error",
  "message": "Azure OpenAI ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.",
  "details": "Azure OpenAI API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ë§Œë£Œë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
}
```

#### AI Detection ë¼ìš°íŠ¸ (`backend/routes/ai-detection.js`)

**ê°œì„  ë‚´ìš©**:
- âœ… ì´ë¯¸ì§€ ë°ì´í„° ê²€ì¦
- âœ… AI ë¶„ì„ ì‹¤íŒ¨ ì‹œ graceful degradation
- âœ… ì—ëŸ¬ ì‘ë‹µ í‘œì¤€í™”

**ì—ëŸ¬ ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "success": false,
  "error": "internal_error",
  "message": "AI ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ í•˜ìë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.",
  "fallback": true
}
```

#### YouTube ê²€ìƒ‰ ë¼ìš°íŠ¸ (`backend/routes/youtube-search.js`)

**ê°œì„  ë‚´ìš©** (ì´ì „ì— êµ¬í˜„ë¨):
- âœ… API í‚¤ ê²€ì¦
- âœ… ì—ëŸ¬ ìœ í˜•ë³„ ì²˜ë¦¬ (403, 400, 401, ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜)
- âœ… ìƒì„¸í•œ ì—ëŸ¬ ë¡œê¹…

---

### 4. í”„ë¡ íŠ¸ì—”ë“œ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 

#### API í´ë¼ì´ì–¸íŠ¸ (`webapp/js/api.js`)

**ê°œì„  ë‚´ìš©**:
- âœ… JSON ì—ëŸ¬ ì‘ë‹µ íŒŒì‹±
- âœ… ì—ëŸ¬ ìƒì„¸ ì •ë³´ ì¶”ì¶œ (message, details, error code)
- âœ… ì¬ì‹œë„ ë¡œì§ (ì„œë²„ ì˜¤ë¥˜ ì‹œ)
- âœ… íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬

**ì—ëŸ¬ ì²˜ë¦¬ ì˜ˆì‹œ**:
```javascript
try {
  const response = await api.searchYouTubeVideos(query);
  // ì„±ê³µ ì²˜ë¦¬
} catch (error) {
  // error.message, error.details, error.status ì‚¬ìš© ê°€ëŠ¥
  console.error('ì—ëŸ¬:', error.message);
  // graceful degradation
}
```

#### ì•± ë¡œì§ (`webapp/js/app.js`)

**ê°œì„  ë‚´ìš©**:
- âœ… YouTube ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ ë™ì˜ìƒ ìë™ ì‚¬ìš©
- âœ… ì—ëŸ¬ ìœ í˜•ë³„ ì¡°ìš©í•œ ì‹¤íŒ¨ ì²˜ë¦¬
- âœ… ì‚¬ìš©ì ê²½í—˜ì„ í•´ì¹˜ì§€ ì•ŠëŠ” ì—ëŸ¬ ì²˜ë¦¬

**ì˜ˆì‹œ**:
```javascript
try {
  const searchResult = await api.searchYouTubeVideos(categoryDetail.name, 3);
  // ê²€ìƒ‰ ì„±ê³µ ì²˜ë¦¬
} catch (youtubeError) {
  // ì¡°ìš©íˆ ì‹¤íŒ¨í•˜ê³  ê¸°ì¡´ ë™ì˜ìƒ ì‚¬ìš©
  if (categoryDetail.videos && categoryDetail.videos.length > 0) {
    loadYouTubeVideo(categoryDetail.videos[0]);
  }
}
```

---

### 5. ì„œë²„ ë ˆë²¨ ì—ëŸ¬ í•¸ë“¤ë§

**íŒŒì¼**: `backend/server.js`

**ê°œì„  ë‚´ìš©**:
- âœ… ì¤‘ì•™í™”ëœ ì—ëŸ¬ í•¸ë“¤ë§ ë¯¸ë“¤ì›¨ì–´ ì‚¬ìš©
- âœ… í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ìƒì„¸ ì—ëŸ¬ ì •ë³´ ìˆ¨ê¹€
- âœ… í‘œì¤€í™”ëœ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹

---

## ğŸ“Š ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

### 1. Graceful Degradation (ìš°ì•„í•œ ì„±ëŠ¥ ì €í•˜)

**ì›ì¹™**: ê¸°ëŠ¥ì´ ì‘ë™í•˜ì§€ ì•Šë”ë¼ë„ ì•±ì´ ê³„ì† ì‹¤í–‰ë˜ë„ë¡

**ì˜ˆì‹œ**:
- YouTube ê²€ìƒ‰ ì‹¤íŒ¨ â†’ ê¸°ì¡´ ë™ì˜ìƒ ì‚¬ìš©
- AI ë¶„ì„ ì‹¤íŒ¨ â†’ ìˆ˜ë™ ë“±ë¡ ì•ˆë‚´
- SMS ë°œì†¡ ì‹¤íŒ¨ â†’ Mock SMS ì‚¬ìš© (ê°œë°œ í™˜ê²½)

### 2. ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€

**ì›ì¹™**: ê¸°ìˆ ì  ì—ëŸ¬ë¥¼ ì‚¬ìš©ìê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ë©”ì‹œì§€ë¡œ ë³€í™˜

**ì˜ˆì‹œ**:
- "YouTube API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤" â†’ "YouTube ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ì¡´ ë™ì˜ìƒì„ ì‚¬ìš©í•©ë‹ˆë‹¤."
- "Azure OpenAI ì¸ì¦ ì‹¤íŒ¨" â†’ "AI ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ í•˜ìë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”."

### 3. ì—ëŸ¬ ë¡œê¹…

**ì›ì¹™**: ê°œë°œìëŠ” ìƒì„¸í•œ ì •ë³´ë¥¼, ì‚¬ìš©ìëŠ” ê°„ë‹¨í•œ ë©”ì‹œì§€ë¥¼

**ì˜ˆì‹œ**:
```javascript
// ê°œë°œ í™˜ê²½: ìƒì„¸ ì •ë³´ í¬í•¨
{
  "error": "internal_error",
  "message": "AI ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",
  "details": "Connection timeout after 30s"
}

// í”„ë¡œë•ì…˜ í™˜ê²½: ìƒì„¸ ì •ë³´ ìˆ¨ê¹€
{
  "error": "internal_error",
  "message": "AI ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
}
```

---

## ğŸ” ê¸°ëŠ¥ë³„ ì—ëŸ¬ ì²˜ë¦¬

### YouTube ê²€ìƒ‰
- **API í‚¤ ë¯¸ì„¤ì •**: ê¸°ì¡´ ë™ì˜ìƒ ì‚¬ìš©
- **í• ë‹¹ëŸ‰ ì´ˆê³¼**: ê¸°ì¡´ ë™ì˜ìƒ ì‚¬ìš©
- **ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜**: ê¸°ì¡´ ë™ì˜ìƒ ì‚¬ìš©

### Azure AI íŒì •
- **API í‚¤ ë¯¸ì„¤ì •**: ê¸°ëŠ¥ ë¹„í™œì„±í™”, ìˆ˜ë™ ë“±ë¡ ì•ˆë‚´
- **ì¸ì¦ ì‹¤íŒ¨**: ëª…í™•í•œ ë©”ì‹œì§€, ìˆ˜ë™ ë“±ë¡ ì•ˆë‚´
- **í• ë‹¹ëŸ‰ ì´ˆê³¼**: ëŒ€ê¸° ì•ˆë‚´, ìˆ˜ë™ ë“±ë¡ ì•ˆë‚´
- **ë¶„ì„ ì‹¤íŒ¨**: ìˆ˜ë™ ë“±ë¡ ì•ˆë‚´

### SMS ë°œì†¡
- **ì„¤ì • ë¯¸ì™„ë£Œ**: Mock SMS ì‚¬ìš© (ê°œë°œ í™˜ê²½)
- **ë°œì†¡ ì‹¤íŒ¨**: ì—ëŸ¬ ë¡œê¹…, ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼

### í‘¸ì‹œ ì•Œë¦¼
- **VAPID í‚¤ ë¯¸ì„¤ì •**: ê¸°ëŠ¥ ë¹„í™œì„±í™”
- **ë°œì†¡ ì‹¤íŒ¨**: ì—ëŸ¬ ë¡œê¹…, ì•±ì€ ê³„ì† ì‘ë™

---

## ğŸ› ï¸ ì‚¬ìš© ê°€ì´ë“œ

### ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ì‹œ

```javascript
const { asyncHandler, isFeatureAvailable, createFeatureUnavailableError } = require('../utils/errorHandler');

router.post('/endpoint', authenticateToken, asyncHandler(async (req, res) => {
  // 1. ì…ë ¥ ê²€ì¦
  if (!req.body.requiredField) {
    return res.status(400).json({
      success: false,
      error: 'validation_error',
      message: 'í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.'
    });
  }

  // 2. ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬ (ì„ íƒì )
  if (!isFeatureAvailable('feature-name')) {
    return res.status(503).json(createFeatureUnavailableError('feature-name'));
  }

  // 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
  try {
    const result = await someOperation();
    res.json({ success: true, data: result });
  } catch (error) {
    // 4. ì—ëŸ¬ ì²˜ë¦¬ (asyncHandlerê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ì§€ë§Œ ì¶”ê°€ ì²˜ë¦¬ ê°€ëŠ¥)
    const errorResponse = createSafeErrorResponse(error, 'ì‘ì—…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
    res.status(500).json({
      success: false,
      ...errorResponse
    });
  }
}));
```

### í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì—ëŸ¬ ì²˜ë¦¬

```javascript
try {
  const result = await api.someMethod();
  // ì„±ê³µ ì²˜ë¦¬
} catch (error) {
  // ì—ëŸ¬ ì •ë³´ ì‚¬ìš©
  console.error('ì—ëŸ¬:', error.message);
  console.error('ìƒì„¸:', error.details);
  
  // ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ í‘œì‹œ (í•„ìš” ì‹œ)
  if (error.status === 503) {
    // ê¸°ëŠ¥ ì‚¬ìš© ë¶ˆê°€
    toast('ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'warning');
  } else {
    // ê¸°íƒ€ ì—ëŸ¬
    handleAPIError(error, 'ì‘ì—…');
  }
  
  // Graceful degradation
  // ì˜ˆ: ëŒ€ì²´ ë°©ë²• ì‚¬ìš©
}
```

---

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°±ì—”ë“œ
- [x] ì¤‘ì•™í™”ëœ ì—ëŸ¬ í•¸ë“¤ë§ ìœ í‹¸ë¦¬í‹° ìƒì„±
- [x] í™˜ê²½ë³€ìˆ˜ ì²´í¬ ë¡œì§ ì¶”ê°€
- [x] Azure AI ë¼ìš°íŠ¸ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 
- [x] AI Detection ë¼ìš°íŠ¸ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 
- [x] YouTube ê²€ìƒ‰ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„  (ì´ì „ ì‘ì—…)
- [x] ì„œë²„ ë ˆë²¨ ì—ëŸ¬ í•¸ë“¤ë§ ë¯¸ë“¤ì›¨ì–´ ì ìš©
- [ ] SMS ë¼ìš°íŠ¸ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 
- [ ] í‘¸ì‹œ ì•Œë¦¼ ë¼ìš°íŠ¸ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 
- [ ] ê¸°íƒ€ ë¼ìš°íŠ¸ ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„ 

### í”„ë¡ íŠ¸ì—”ë“œ
- [x] API í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ íŒŒì‹± ê°œì„ 
- [x] YouTube ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ graceful degradation
- [x] ì¤‘ì•™í™”ëœ ì—ëŸ¬ í•¸ë“¤ëŸ¬ ì‚¬ìš©
- [ ] AI ë¶„ì„ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì ì•ˆë‚´ ê°œì„ 
- [ ] ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬ ê°œì„ 

---

## ğŸ¯ ì˜ˆìƒ íš¨ê³¼

### ì‚¬ìš©ì ê²½í—˜
- âœ… ê¸°ëŠ¥ì´ ì‘ë™í•˜ì§€ ì•Šì•„ë„ ì•± ì‚¬ìš© ê°€ëŠ¥
- âœ… ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€
- âœ… ëŒ€ì²´ ë°©ë²• ìë™ ì œê³µ

### ê°œë°œì ê²½í—˜
- âœ… ìƒì„¸í•œ ì—ëŸ¬ ë¡œê¹…
- âœ… í‘œì¤€í™”ëœ ì—ëŸ¬ ì²˜ë¦¬
- âœ… ë””ë²„ê¹… ìš©ì´ì„± í–¥ìƒ

### ì‹œìŠ¤í…œ ì•ˆì •ì„±
- âœ… ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ë¡œ ì¸í•œ ì•± ì¤‘ë‹¨ ë°©ì§€
- âœ… Graceful degradationìœ¼ë¡œ ë¶€ë¶„ ê¸°ëŠ¥ ì¥ì•  ê²©ë¦¬
- âœ… í™˜ê²½ë³€ìˆ˜ ë¯¸ì„¤ì • ì‹œì—ë„ ì„œë²„ ì‹¤í–‰ ê°€ëŠ¥

---

**ì‘ì„± ì¼ì‹œ**: 2025-11-19  
**ë²„ì „**: v4.0.0

